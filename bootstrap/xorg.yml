sources:
  - name: xorg-util-macros
    subdir: 'bundled'
    git: 'https://gitlab.freedesktop.org/xorg/util/macros.git'
    tag: 'util-macros-1.19.3'
    version: '1.19.3'
    tools_required:
      - host-autoconf-v2.69
      - host-automake-v1.16
      - host-libtool
      - host-pkg-config
    regenerate:
      - args: ['./autogen.sh']
        environ:
          NOCONFIGURE: 'yes'

  - name: xorg-font-util
    subdir: 'bundled'
    git: 'https://gitlab.freedesktop.org/xorg/font/util.git'
    tag: 'font-util-1.3.2'
    version: '1.3.2'
    tools_required:
      - host-autoconf-v2.69
      - host-automake-v1.16
      - host-libtool
      - host-pkg-config
      - host-xorg-macros
    regenerate:
      - args: ['./autogen.sh']
        environ:
          NOCONFIGURE: 'yes'

  - name: gettext
    subdir: 'bundled'
    git: 'https://git.savannah.gnu.org/git/gettext.git'
    tag: 'v0.19.8'
    version: '0.19.8'
    tools_required:
      - host-autoconf-v2.69
      - host-automake-v1.16
      - host-libtool
      - host-pkg-config
    regenerate:
      - args: ['./autogen.sh']
        environ:
          NOCONFIGURE: 'yes'

  - name: gobject-introspection
    subdir: 'bundled'
    git: 'https://gitlab.gnome.org/GNOME/gobject-introspection.git'
    tag: '1.76.1'
    version: '1.76.1'

tools:
  - name: host-gobject-introspection
    exports_aclocal: true
    from_source: gobject-introspection
    tools_required:
      - host-python
      - host-glib
      - host-pkg-config
      - virtual: pkgconfig-for-host
        program_name: host-pkg-config
    configure:
      - args:
        - 'meson'
        - '--prefix=@PREFIX@'
        - '--native-file'
        - '@SOURCE_ROOT@/userland/native-file.ini'
        - '-Dbuild_introspection_data=false'
        - '@THIS_SOURCE_DIR@'
    compile:
      - args: ['ninja']
    install:
      - args: ['ninja', 'install']

  - name: host-xorg-macros
    exports_aclocal: true
    from_source: xorg-util-macros
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--prefix=@PREFIX@'
    compile:
      - args: ['make', '-j@PARALLELISM@']
    install:
      - args: ['make', 'install-strip']

  - name: host-xtrans
    exports_aclocal: true
    from_source: libxtrans
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--prefix=@PREFIX@'
    compile:
      - args: ['make', '-j@PARALLELISM@']
    install:
      - args: ['make', 'install-strip']

  - name: host-xorg-font-util
    exports_aclocal: true
    from_source: xorg-font-util
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--prefix=@PREFIX@'
    compile:
      - args: ['make', '-j@PARALLELISM@']
    install:
      - args: ['make', 'install-strip']

packages:
  # `xorg-util-macros` is a set of autoconf macros used by the configure.ac scripts in
  # other Xorg modular packages, and is needed to generate new versions
  # of their configure scripts with autoconf.
  - name: xorg-util-macros
    from_source: xorg-util-macros
    tools_required:
      - host-gcc
      - host-xorg-macros
    pkgs_required:
      - mlibc
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=x86_64-aero'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install-strip']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  # `xorg-proto` provides the headers and specification documents defining the core protocol
  # and extensions for the X Window System. 
  - name: xorg-proto
    source:
      subdir: 'bundled'
      git: 'https://gitlab.freedesktop.org/xorg/proto/xorgproto.git'
      tag: 'xorgproto-2022.1'
      version: '2022.1'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.16
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
      regenerate:
        - args: ['./autogen.sh']
          environ:
            NOCONFIGURE: 'yes'
    tools_required:
      - host-gcc
    pkgs_required:
      - mlibc
      - xorg-util-macros
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=x86_64-aero'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install-strip']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  # `xcb-proto` provides the XML-XCB protocol descriptions that libxcb uses to
  # generate the majority of its code and API.
  - name: xcb-proto
    source:
      subdir: 'bundled'
      git: 'https://gitlab.freedesktop.org/xorg/proto/xcbproto.git'
      tag: 'xcb-proto-1.15'
      version: '1.15'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.16
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
      regenerate:
        - args: ['./autogen.sh']
          environ:
            NOCONFIGURE: 'yes'
    tools_required:
      - host-gcc
      - host-python
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libxau
      - libxdmcp
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=x86_64-aero'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        environ:
          PYTHON: '@BUILD_ROOT@/tools/host-python/bin/python3.8'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install-strip']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: libxcb-image
    source:
      subdir: 'bundled'
      git: 'https://gitlab.freedesktop.org/xorg/lib/libxcb-image'
      tag: 'xcb-util-image-0.4.1'
      version: '0.4.1'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.16
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
      regenerate:
        - args: ['git', 'submodule', 'update', '--init']
        - args: ['./autogen.sh']
          environ:
            NOCONFIGURE: 'yes'
    tools_required:
      - host-gcc
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=x86_64-aero'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install-strip']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: libxcb-util
    source:
      subdir: 'bundled'
      git: 'https://gitlab.freedesktop.org/xorg/lib/libxcb-util'
      tag: 'xcb-util-0.4.1'
      version: '0.4.1'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.16
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
      regenerate:
        - args: ['git', 'submodule', 'update', '--init']
        - args: ['./autogen.sh']
          environ:
            NOCONFIGURE: 'yes'
    tools_required:
      - host-gcc
      - host-python
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=x86_64-aero'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install-strip']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  # `libxdmcp` is X Display Manager Control Protocol library.
  - name: libxdmcp
    source:
      subdir: 'bundled'
      git: 'https://gitlab.freedesktop.org/xorg/lib/libxdmcp.git'
      tag: 'libXdmcp-1.1.3'
      version: '1.1.3'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.16
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
      regenerate:
        - args: ['./autogen.sh']
          environ:
            NOCONFIGURE: 'yes'
    tools_required:
      - host-gcc
      - host-autoconf-v2.69
      - host-automake-v1.16
      - host-pkg-config
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libxau
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=x86_64-aero'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install-strip']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  # `xtrans` is a library of code that is shared among various X packages to
  # handle network protocol transport in a modular fashion.
  - name: libxtrans
    from_source: libxtrans
    tools_required:
      - host-gcc
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libxcb
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=x86_64-aero'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install-strip']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  # `libxau` is a sample authorization protocol for X
  - name: libxau
    source:
      subdir: 'bundled'
      git: 'https://gitlab.freedesktop.org/xorg/lib/libxau.git'
      tag: 'libXau-1.0.9'
      version: '1.0.9'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.16
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
      regenerate:
        - args: ['./autogen.sh']
          environ:
            NOCONFIGURE: 'yes'
    tools_required:
      - host-gcc
      - host-autoconf-v2.69
      - host-automake-v1.16
      - host-pkg-config
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=x86_64-aero'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install-strip']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  # `libxcb` provides an interface to the X Window System protocol, which
  # replaces the traditional Xlib interface. 
  - name: libxcb
    source:
      subdir: 'bundled'
      git: 'https://gitlab.freedesktop.org/xorg/lib/libxcb.git'
      tag: 'libxcb-1.15'
      version: '1.15'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.16
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
      regenerate:
        - args: ['./autogen.sh']
          environ:
            NOCONFIGURE: 'yes'
    tools_required:
      - host-gcc
      - host-autoconf-v2.69
      - host-automake-v1.16
      - host-pkg-config
      - host-python
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libxau
      - libxdmcp
      - xcb-proto
    configure:
      - args: ['sed', '-i', "s/pthread-stubs//", '@THIS_SOURCE_DIR@/configure']
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=x86_64-aero'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
        - '--without-doxygen'
        - '--with-sysroot=@SYSROOT_DIR@' # Set libtool's lt_sysroot.
        environ:
            PYTHON: '@BUILD_ROOT@/tools/host-python/bin/python3.8'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install-strip']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  # `libx11` is core X11 protocol client library.
  - name: libx11
    source:
      subdir: 'bundled'
      git: 'https://gitlab.freedesktop.org/xorg/lib/libx11.git'
      tag: 'libX11-1.8'
      version: '1.8'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.16
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
        - host-xtrans
      regenerate:
        - args: ['./autogen.sh']
          environ:
            NOCONFIGURE: 'yes'
    tools_required:
      - host-gcc
      - host-autoconf-v2.69
      - host-automake-v1.16
      - host-pkg-config
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libxcb
      - libxtrans
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=x86_64-aero'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
        - '--disable-ipv6'
        - '--disable-malloc0returnsnull'
        - '--with-keysymdefdir=@SYSROOT_DIR@/usr/include/X11'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install-strip']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: libxcursor
    source:
      subdir: bundled
      git: 'https://gitlab.freedesktop.org/xorg/lib/libxcursor.git'
      tag: 'libXcursor-1.2.1'
      version: '1.2.1'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.16
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
      regenerate:
        - args: ['./autogen.sh']
          environ:
            'NOCONFIGURE': 'yes'
    tools_required:
      - host-gcc
      - host-autoconf-v2.69
      - host-automake-v1.16
      - host-pkg-config
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libx11
      - libxfixes
      - libxrender
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=x86_64-aero'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: glu
    source:
      subdir: 'bundled'
      git: 'https://gitlab.freedesktop.org/mesa/glu.git'
      tag: 'glu-9.0.2'
      version: '9.0.2'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.16
        - host-libtool
        - host-pkg-config
      regenerate:
        - args: ['./autogen.sh']
          environ:
            NOCONFIGURE: '1'
    tools_required:
      - host-gcc
    pkgs_required:
      - mlibc
      - gcc # Actually requires libstdc++.so in the system root, otherwise it links against the host libstdc++.so.6
      - mesa
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=x86_64-aero'
        - '--prefix=/usr'
        - '--disable-static'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: mesa-demos
    source:
      subdir: 'bundled'
      git: 'https://gitlab.freedesktop.org/mesa/demos.git/'
      branch: 'master'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.16
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
      regenerate:
        - args: ['./autogen.sh']
          environ:
            'NOCONFIGURE': 'yes'
    tools_required:
      - host-gcc
    pkgs_required:
      - mlibc
      - mesa
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=x86_64-aero'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
        - '--disable-gles1' # Requires some linux header that we don't have
        - '--disable-vg'
        - '--disable-osmesa'
        - '--disable-rbug'
        - '--with-system-data-files'
    build:
    - args: ['make', '-j@PARALLELISM@']
    - args: ['make', 'install']
      environ:
        DESTDIR: '@THIS_COLLECT_DIR@'

  - name: mesa
    source:
      subdir: 'bundled'
      git: 'https://gitlab.freedesktop.org/mesa/mesa.git'
      tag: 'mesa-21.3.5'
      version: '21.3.5'
      tools_required:
        - host-pkg-config
    tools_required:
      - host-pkg-config
      - host-gcc
      - virtual: pkgconfig-for-target
        triple: "x86_64-aero"
      - virtual: pkgconfig-for-host
        program_name: host-pkg-config
    pkgs_required:
      - mlibc
      - libdrm
      - zlib
      - libxrandr
      - libxfixes
      - libx11
      - libxext
      - libxcb
      - llvm
    configure:
      - args: ['cp', '@SOURCE_ROOT@/userland/cross-file.ini', 'meson.cross-file']
      - args:
        - 'sed'
        - '-i'
        - "/^# sed adds binaries here.$/a llvm-config = '@SOURCE_ROOT@/userland/cross-llvm-config'"
        - 'meson.cross-file'
      - args:
        - 'meson'
        - 'setup'
        - '--native-file'
        - '@SOURCE_ROOT@/userland/native-file.ini'
        - '--cross-file'
        - 'meson.cross-file'
        - '--prefix=/usr'
        - '--libdir=lib'
        # The debug build type enables some additional output from Mesa.
        - '--buildtype=release'
        #- '--buildtype=debug'
        - '-Dglx=gallium-xlib'
        - '-Dplatforms=x11'
        # The Gallium swrast driver seems to be preferred over dri-swrast.
        - '-Ddri-drivers='
        - '-Dgallium-drivers=swrast'
        - '-Dvulkan-drivers='
        # Force Mesa to build with LLVM.
        - '-Dllvm=enabled'
        - '@THIS_SOURCE_DIR@'
    build:
      - args: ['ninja', '-j@PARALLELISM@']
      - args: ['ninja', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  # `libxkbfile` is used by the X servers and utilities to parse the XKB
  # configuration data files.
  - name: libxkbfile
    source:
      subdir: 'bundled'
      git: 'https://gitlab.freedesktop.org/xorg/lib/libxkbfile.git'
      tag: 'libxkbfile-1.1.0'
      version: '1.1.0'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.16
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
      regenerate:
        - args: ['./autogen.sh']
          environ:
            NOCONFIGURE: 'yes'
    tools_required:
      - host-gcc
      - host-autoconf-v2.69
      - host-automake-v1.16
      - host-pkg-config
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libx11
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=x86_64-aero'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install-strip']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: xorg-font-util
    from_source: xorg-font-util
    tools_required:
      - host-gcc
    pkgs_required:
      - mlibc
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=x86_64-aero'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install-strip']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  # `libfontenc` is a font encoding library.
  - name: libfontenc
    source:
      subdir: 'bundled'
      git: 'https://gitlab.freedesktop.org/xorg/lib/libfontenc.git'
      tag: 'libfontenc-1.1.4'
      version: '1.1.4'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.16
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
        - host-xorg-font-util
      regenerate:
        - args: ['./autogen.sh']
          environ:
            NOCONFIGURE: 'yes'
    tools_required:
      - host-gcc
      - host-autoconf-v2.69
      - host-automake-v1.16
      - host-pkg-config
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libx11
      - libxtrans
      - xorg-font-util
      - zlib
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=x86_64-aero'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install-strip']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: xf86-input-mouse
    source:
      subdir: 'bundled'
      git: 'https://gitlab.freedesktop.org/xorg/driver/xf86-input-mouse.git'
      tag: 'xf86-input-mouse-1.9.4'
      version: '1.9.4'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.16
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
      regenerate:
        - args: ['./autogen.sh']
          environ:
            NOCONFIGURE: 'yes'
    tools_required:
      - host-gcc
      - host-autoconf-v2.69
      - host-automake-v1.16
      - host-pkg-config
    pkgs_required:
      - mlibc
      - xorg-server
      - xorg-util-macros
      - libx11
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=x86_64-aero'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
        - '--with-sysroot=@SYSROOT_DIR@' # Set libtool's lt_sysroot.
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install-strip']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  # `libxfont` provides the core of the legacy X11 font system, handling the index
  # files
  - name: libxfont2
    source:
      subdir: 'bundled'
      git: 'https://gitlab.freedesktop.org/xorg/lib/libxfont.git'
      tag: 'libXfont2-2.0.5'
      version: '2.0.5'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.16
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
        - host-xtrans
      regenerate:
        - args: ['./autogen.sh']
          environ:
            NOCONFIGURE: 'yes'
    tools_required:
      - host-gcc
      - host-autoconf-v2.69
      - host-automake-v1.16
      - host-pkg-config
      - host-xtrans
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libx11
      - libxtrans
      - freetype
      - libfontenc
      - fontconfig
      - zlib
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=x86_64-aero'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
        - '--disable-devel-docs'
        # strcasecmp is implicitly declared, probably an missing include somewhere, so disable -Werror for that
        - '--disable-selective-werror'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install-strip']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  # `pixman` is a library that provides low-level pixel manipulation
  # features such as image compositing and trapezoid rasterization.
  - name: pixman
    source:
      subdir: 'bundled'
      git: 'https://gitlab.freedesktop.org/pixman/pixman.git'
      tag: 'pixman-0.40.0'
      version: '0.40.0'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.16
        - host-libtool
        - host-pkg-config
      regenerate:
        - args: ['./autogen.sh']
          environ:
            'NOCONFIGURE': 'yes'
    tools_required:
      - host-autoconf-v2.69
      - host-automake-v1.16
      - host-libtool
      - host-pkg-config
      - host-gcc
    pkgs_required:
      - mlibc
      - libpng
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=x86_64-aero'
        - '--prefix=/usr'
        - '--with-sysroot=@SYSROOT_DIR@' # Set libtool's lt_sysroot.
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: libepoxy
    source:
      subdir: 'bundled'
      git: 'https://github.com/anholt/libepoxy.git'
      tag: '1.5.10'
      version: '1.5.10'
    tools_required:
      - host-pkg-config
      - host-gcc
      - virtual: pkgconfig-for-target
        triple: "@OPTION:x86_64-aero"
    pkgs_required:
      - mlibc
      - mesa
      - xorg-proto
      - libx11
    configure:
      - args:
          - 'meson'
          - '--cross-file'
          - '@SOURCE_ROOT@/userland/cross-file.ini'
          - '--prefix=/usr'
          - '-Degl=no'
          - '-Dtests=false'
          - '@THIS_SOURCE_DIR@'
    build:
      - args: ['ninja']
      - args: ['ninja', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: xorg-xinit
    source:
      subdir: 'bundled'
      git: 'https://gitlab.freedesktop.org/xorg/app/xinit'
      tag: 'xinit-1.3.4'
      version: '1.3.4'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.16
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
        - host-xorg-font-util
        - host-xtrans
      regenerate:
        - args: ['./autogen.sh']
          environ:
            NOCONFIGURE: 'yes'
    tools_required:
      - host-autoconf-v2.69
      - host-automake-v1.16
      - host-gcc
      - host-pkg-config
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - xorg-server
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=x86_64-aero'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install-strip']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'
      - args: ['cp', '@SOURCE_ROOT@/extra-files/xorg/xinitrc', '@THIS_COLLECT_DIR@/etc/X11/xinit/xinitrc']

  # X.Org xcvt library and cvt program
  #
  # VESA CVT standard timing modeline generation library & utility.
  - name: libxcvt
    source:
      subdir: 'bundled'
      git: 'https://gitlab.freedesktop.org/xorg/lib/libxcvt.git'
      tag: 'libxcvt-0.1.2'
      version: '0.1.2'
    tools_required:
      - host-gcc
      - host-pkg-config
    pkgs_required:
      - mlibc
    configure:
      - args:
        - 'meson'
        - '--cross-file'
        - '@SOURCE_ROOT@/userland/cross-file.ini'
        - '--prefix=/usr'
        - '@THIS_SOURCE_DIR@'
    build:
      - args: ['ninja', '-j@PARALLELISM@']
      - args: ['ninja', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  # The X server accepts requests from client applications to create windows,
  # which are (normally rectangular) "virtual screens" that the client program
  # can draw into.
  - name: xorg-server
    source:
      subdir: 'bundled'
      git: 'https://gitlab.freedesktop.org/xorg/xserver.git'
      tag: 'xorg-server-1.20.14'
      version: '1.20.14'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.16
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
        - host-xorg-font-util
        - host-xtrans
      regenerate:
        - args: ['./autogen.sh']
          environ:
            NOCONFIGURE: 'yes'
    tools_required:
      - host-gcc
      - host-pkg-config
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - openssl
      - libepoxy
      - libxkbfile
      - libxfont2
      - libxcvt
      - pixman
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=x86_64-aero'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
        - '--with-sysroot=@SYSROOT_DIR@' # Set libtool's lt_sysroot.
        - '--with-xkb-output=/var/lib/xkb'
        - '--enable-xorg'
        - '--enable-xv'
        - '--enable-xvfb'
        - '--disable-xephyr'
        - '--disable-xwayland'
        - '--disable-xnest'
        - '--disable-dmx'
        - '--disable-suid-wrapper'
        - '--disable-pciaccess'
        - '--disable-dpms'
        - '--disable-screensaver'
        - '--disable-xres'
        - '--disable-xinerama'
        - '--disable-xvmc'
        - '--disable-systemd-logind'
        - '--disable-secure-rpc'
        - '--disable-config-udev'
        - '--disable-dri'
        - '--disable-dri2'
        - '--disable-dri3'
        - '--disable-vbe'
        - '--disable-int10-module'
        - '--disable-vgahw'
        - '--disable-libdrm'
        - '--disable-glamor'
        - '--disable-glx'
        environ:
          CFLAGS: '-Wno-error=array-bounds -pipe'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'
      - args: ['mkdir', '-p', '@THIS_COLLECT_DIR@/etc/X11']
      - args: ['cp', '@SOURCE_ROOT@/extra-files/xorg/xorg.conf', '@THIS_COLLECT_DIR@/etc/X11/']

  # `libxext` is the historical libX11-based catchall library for the X11
  # extensions without their own libraries.
  - name: libxext
    source:
      subdir: 'bundled'
      git: 'https://gitlab.freedesktop.org/xorg/lib/libxext.git'
      tag: 'libXext-1.3.4'
      version: '1.3.4'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.16
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
      regenerate:
        - args: ['./autogen.sh']
          environ:
            NOCONFIGURE: 'yes'
    tools_required:
      - host-gcc
      - host-autoconf-v2.69
      - host-automake-v1.16
      - host-pkg-config
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libx11
      - libxtrans
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=x86_64-aero'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
        - '--disable-malloc0returnsnull'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install-strip']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  # `libsm` is a X session management library.
  - name: libsm
    source:
      subdir: 'bundled'
      git: 'https://gitlab.freedesktop.org/xorg/lib/libsm.git'
      tag: 'libSM-1.2.3'
      version: '1.2.3'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.16
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
        - host-xtrans
      regenerate:
        - args: ['./autogen.sh']
          environ:
            NOCONFIGURE: 'yes'
    tools_required:
      - host-autoconf-v2.69
      - host-automake-v1.16
      - host-gcc
      - host-pkg-config
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libx11
      - libxtrans
      - libice
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=x86_64-aero'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install-strip']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: libxt
    source:
      subdir: 'bundled'
      git: 'https://gitlab.freedesktop.org/xorg/lib/libxt.git'
      tag: 'libXt-1.2.1'
      version: '1.2.1'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.16
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
      regenerate:
        - args: ['./autogen.sh']
          environ:
            NOCONFIGURE: 'yes'
    tools_required:
      - host-autoconf-v2.69
      - host-automake-v1.16
      - host-pkg-config
      - host-gcc
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libx11
      - libxtrans
      - libsm
      - libice
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=x86_64-aero'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
        - '--disable-malloc0returnsnull'
        - '--with-appdefaultdir=/etc/X11/app-defaults'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install-strip']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  # `libxmu` contains miscellaneous utilities and is not part of the Xlib
  # standard
  - name: libxmu
    source:
      subdir: 'bundled'
      git: 'https://gitlab.freedesktop.org/xorg/lib/libxmu.git'
      tag: 'libXmu-1.1.3'
      version: '1.1.3'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.16
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
        - host-xtrans
      regenerate:
        - args: ['./autogen.sh']
          environ:
            NOCONFIGURE: 'yes'
    tools_required:
      - host-autoconf-v2.69
      - host-automake-v1.16
      - host-pkg-config
      - host-gcc
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libx11
      - libxext
      - libxtrans
      - libxt
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=x86_64-aero'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install-strip']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  # `libice` is a inter-client exchange library.
  - name: libice
    source:
      subdir: 'bundled'
      git: 'https://gitlab.freedesktop.org/xorg/lib/libice.git'
      tag: 'libICE-1.0.10'
      version: '1.0.10'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.16
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
        - host-xtrans
      regenerate:
        - args: ['./autogen.sh']
          environ:
            NOCONFIGURE: 'yes'
    tools_required:
      - host-autoconf-v2.69
      - host-automake-v1.16
      - host-pkg-config
      - host-gcc
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libx11
      - libxtrans
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=x86_64-aero'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install-strip']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  # `libxaw` is the X athena widget set.
  - name: libxaw
    source:
      subdir: 'bundled'
      git: 'https://gitlab.freedesktop.org/xorg/lib/libxaw.git'
      tag: 'libXaw-1.0.14'
      version: '1.0.14'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.16
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
      regenerate:
        - args: ['./autogen.sh']
          environ:
            NOCONFIGURE: 'yes'
    tools_required:
      - host-autoconf-v2.69
      - host-automake-v1.16
      - host-pkg-config
      - host-gcc
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libx11
      - libxext
      - libxt
      - libxmu
      - libxpm
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=x86_64-aero'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install-strip']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  # `libxpm` is X Pixmap (XPM) image file format library.
  - name: libxpm
    source:
      subdir: 'bundled'
      git: 'https://gitlab.freedesktop.org/xorg/lib/libxpm.git'
      tag: 'libXpm-3.5.13'
      version: '3.5.13'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.16
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
      regenerate:
        - args: ['./autogen.sh']
          environ:
            NOCONFIGURE: 'yes'
    tools_required:
      - host-autoconf-v2.69
      - host-automake-v1.16
      - host-pkg-config
      - host-gcc
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libx11
      - libxext
      - libxt
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=x86_64-aero'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install-strip']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  # `libxrender` is a library for the Render Extension to the X11 protocol
  - name: libxrender
    source:
      subdir: 'bundled'
      git: 'https://gitlab.freedesktop.org/xorg/lib/libxrender.git'
      tag: 'libXrender-0.9.10'
      version: '0.9.10'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.16
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
      regenerate:
        - args: ['./autogen.sh']
          environ:
            NOCONFIGURE: 'yes'
    tools_required:
      - host-gcc
      - host-autoconf-v2.69
      - host-automake-v1.16
      - host-pkg-config
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libx11
      - libxtrans
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=x86_64-aero'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
        - '--disable-malloc0returnsnull'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install-strip']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  # `libxft` is X FreeType library.
  - name: libxft
    source:
      subdir: 'bundled'
      git: 'https://gitlab.freedesktop.org/xorg/lib/libxft.git'
      tag: 'libXft-2.3.4'
      version: '2.3.4'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.16
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
      regenerate:
        - args: ['./autogen.sh']
          environ:
            NOCONFIGURE: 'yes'
    tools_required:
      - host-autoconf-v2.69
      - host-automake-v1.16
      - host-pkg-config
      - host-gcc
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libx11
      - libxrender
      - freetype
      - fontconfig
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=x86_64-aero'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
        - '--with-sysroot=@SYSROOT_DIR@' # Set libtool's lt_sysroot.
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install-strip']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  # `libxi` is library for the X input extension.
  - name: libxi
    source:
      subdir: 'bundled'
      git: 'https://gitlab.freedesktop.org/xorg/lib/libxi.git'
      tag: 'libXi-1.8'
      version: '1.8'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.16
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
      regenerate:
        - args: ['./autogen.sh']
          environ:
            NOCONFIGURE: 'yes'
    tools_required:
      - host-gcc
      - host-autoconf-v2.69
      - host-automake-v1.16
      - host-pkg-config
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libx11
      - libxtrans
      - libxext
      - libxfixes
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=x86_64-aero'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
        - '--disable-malloc0returnsnull'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install-strip']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  # `libxfixes` is xfixes extension library.
  - name: libxfixes
    source:
      subdir: 'bundled'
      git: 'https://gitlab.freedesktop.org/xorg/lib/libxfixes.git'
      tag: 'libXfixes-6.0.0'
      version: '6.0.0'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.16
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
      regenerate:
        - args: ['./autogen.sh']
          environ:
            NOCONFIGURE: 'yes'
    tools_required:
      - host-gcc
      - host-autoconf-v2.69
      - host-automake-v1.16
      - host-pkg-config
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libx11
      - libxtrans
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=x86_64-aero'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install-strip']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  # `xeyes` is a follow the mouse X demo, using the X shape extension.
  - name: xeyes
    source:
      subdir: 'bundled'
      git: 'https://gitlab.freedesktop.org/xorg/app/xeyes.git'
      tag: 'xeyes-1.2.0'
      version: '1.2.0'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.16
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
      regenerate:
        - args: ['./autogen.sh']
          environ:
            NOCONFIGURE: 'yes'
    tools_required:
      - host-autoconf-v2.69
      - host-automake-v1.16
      - host-pkg-config
      - host-gcc
    pkgs_required:
      - mlibc
      - libx11
      - libxmu
      - libxaw
      - libxrender
      - libxft
      - libxt
      - libxkbfile
      - libiconv
      - libxi
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=x86_64-aero'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-selective-werror' # strncasecmp
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: limine-term
    source:
      subdir: 'bundled'
      git: 'https://github.com/Andy-Python-Programmer/limine-term-emu'
      branch: 'master'
      regenerate:
        - args: ['git', 'submodule', 'update', '--init']
    tools_required:
      - host-autoconf-v2.69
      - host-automake-v1.16
      - virtual: pkgconfig-for-target
        triple: "x86_64-aero"
      - virtual: pkgconfig-for-host
        program_name: host-pkg-config
      - host-gcc
    pkgs_required:
      - mlibc
      - libx11
      - libxmu
      - libxaw
      - libxrender
      - libxft
      - libxt
      - libxkbfile
      - libiconv
      - libxi
    configure:
      - args:
        - 'meson'
        - '--cross-file'
        - '@SOURCE_ROOT@/userland/cross-file.ini'
        - '--prefix=/usr'
        - '@THIS_SOURCE_DIR@'
    build:
      - args: ['ninja', '-j@PARALLELISM@']
      - args: ['ninja', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: dwm
    source:
      subdir: 'bundled'
      git: 'https://git.suckless.org/dwm/'
      branch: master
    tools_required:
      - host-autoconf-v2.69
      - host-automake-v1.16
      - host-pkg-config
      - host-gcc
    pkgs_required:
      - mlibc
      - libx11
      - libxmu
      - libxaw
      - libxrender
      - libxft
      - libxt
      - libxkbfile
      - libiconv
      - libxi
      - dejavu
    configure:
      - args: ['cp', '-r', '@THIS_SOURCE_DIR@/.', '@THIS_BUILD_DIR@']
    build:
      - args: ['make', 'CC=x86_64-aero-gcc', 'CXX=x86_64-aero-g++']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: xwallpaper
    source:
      subdir: 'bundled'
      git: 'https://github.com/stoeckmann/xwallpaper'
      branch: 'master'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.16
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
      regenerate:
        - args: ['./autogen.sh']
          environ:
            NOCONFIGURE: 'yes'
    tools_required:
      - host-gcc
      - host-pkg-config
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libx11
      - libxcb-image
      - libxcb-util
      - libpng
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=x86_64-aero'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install-strip']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: dmenu
    source:
      subdir: 'bundled'
      git: 'https://git.suckless.org/dmenu/'
      branch: master
    tools_required:
      - host-autoconf-v2.69
      - host-automake-v1.16
      - host-pkg-config
      - host-gcc
    pkgs_required:
      - mlibc
      - libx11
      - libxmu
      - libxaw
      - libxrender
      - libxft
      - libxt
      - libxkbfile
      - libiconv
      - libxi
      - dejavu
    configure:
      - args: ['cp', '-r', '@THIS_SOURCE_DIR@/.', '@THIS_BUILD_DIR@']
    build:
      - args: ['make', 'CC=x86_64-aero-gcc', 'CXX=x86_64-aero-g++']
      - args: ['make', 'install']
        environ:
          PREFIX: '/usr'
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: dejavu
    source:
      subdir: bundled
      url: 'https://sourceforge.net/projects/dejavu/files/dejavu/2.37/dejavu-fonts-ttf-2.37.tar.bz2'
      format: 'tar.bz2'
      checksum: blake2b:d8614907887f20967fc7c75cb33b636a0eb5c682a076ccc7aef09f4ac243507afc005ef90d0b2aeee6a4a6a1ff3d5ce4fac0d1722a382525b3883ef53cdec26a
      extract_path: 'dejavu-fonts-ttf-2.37'
      version: '2.37'
    pkgs_required:
      - freetype
      - fontconfig
    revision: 3
    configure:
      - args: ['cp', '-r', '@THIS_SOURCE_DIR@/ttf', '@THIS_SOURCE_DIR@/dejavu']
      - args: ['cp', '-r', '@THIS_SOURCE_DIR@/', '@THIS_BUILD_DIR@']
    build:
      - args: ['mkdir', '-p', '@THIS_COLLECT_DIR@/usr/share/fonts/truetype/']
      - args: ['cp', '-r', '@THIS_BUILD_DIR@/dejavu/dejavu', '@THIS_COLLECT_DIR@/usr/share/fonts/truetype/']
    scripts:
        post_install:
          - args: 'echo "Running fc-cache; this may take a few seconds..."'
          - args: ['fc-cache']

  - name: libxv
    source:
      subdir: 'bundled'
      git: 'https://gitlab.freedesktop.org/xorg/lib/libxv.git'
      tag: 'libXv-1.0.11'
      version: '1.0.11'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.16
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
      regenerate:
        - args: ['./autogen.sh']
          environ:
            NOCONFIGURE: 'yes'
    tools_required:
      - host-gcc
      - host-autoconf-v2.69
      - host-automake-v1.16
      - host-pkg-config
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libx11
      - libxext
      - libxfixes
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=x86_64-aero'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
        - '--disable-malloc0returnsnull'
        - '--with-sysroot=@SYSROOT_DIR@' # Set libtool's lt_sysroot.
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install-strip']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: libxrandr
    source:
      subdir: 'bundled'
      git: 'https://gitlab.freedesktop.org/xorg/lib/libxrandr.git'
      tag: 'libXrandr-1.5.2'
      version: '1.5.2'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.16
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
      regenerate:
        - args: ['./autogen.sh']
          environ:
            NOCONFIGURE: 'yes'
    tools_required:
      - host-gcc
      - host-autoconf-v2.69
      - host-automake-v1.16
      - host-pkg-config
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libx11
      - libxtrans
      - libxrender
      - libxext
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=x86_64-aero'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
        - '--disable-malloc0returnsnull'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install-strip']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: xkbcomp
    source:
      subdir: 'bundled'
      git: 'https://gitlab.freedesktop.org/xorg/app/xkbcomp.git'
      tag: 'xkbcomp-1.4.5'
      version: '1.4.5'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.16
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
      regenerate:
        - args: ['./autogen.sh']
          environ:
            NOCONFIGURE: 'yes'
    tools_required:
      - host-gcc
      - host-autoconf-v2.69
      - host-automake-v1.16
      - host-pkg-config
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - libx11
      - libxkbfile
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=x86_64-aero'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install-strip']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: libxkbcommon
    source:
      subdir: 'bundled'
      git: 'https://github.com/xkbcommon/libxkbcommon.git'
      tag: 'xkbcommon-1.4.0'
      version: '1.4.0'
    tools_required:
      - host-pkg-config
      - host-gcc
      - virtual: pkgconfig-for-host
        program_name: host-pkg-config
      - virtual: pkgconfig-for-target
        triple: "x86_64-aero"
    pkgs_required:
      - mlibc
      - libxcb
      - libxml
      - xkeyboard-config
    configure:
      - args:
        - 'meson'
        - '--native-file'
        - '@SOURCE_ROOT@/userland/native-file.ini'
        - '--cross-file'
        - '@SOURCE_ROOT@/userland/cross-file.ini'
        - '--prefix=/usr'
        - '--libdir=lib'
        - '--buildtype=release'
        - '-Denable-docs=false'
        - '-Denable-x11=true'
        - '-Denable-wayland=false'
        - '@THIS_SOURCE_DIR@'
    build:
      - args: ['ninja']
      - args: ['ninja', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'
      - args: ['mkdir', '-p', "@THIS_COLLECT_DIR@/usr/share/X11/xkb"]

  - name: xkbutils
    source:
      subdir: 'bundled'
      git: 'https://gitlab.freedesktop.org/xorg/app/xkbutils.git'
      tag: 'xkbutils-1.0.4'
      version: '1.0.4'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.16
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
      regenerate:
        - args: ['autoreconf', '-vfi']
    tools_required:
      - host-autoconf-v2.69
      - host-automake-v1.16
      - host-libtool
      - host-pkg-config
      - host-gcc
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libx11
      - libxt
      - libxaw
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=x86_64-aero'
        - '--prefix=/usr'
        - '--with-sysroot=@SYSROOT_DIR@' # Set libtool's lt_sysroot.
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install-strip']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: xkeyboard-config
    source:
      subdir: 'bundled'
      git: 'https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config.git'
      tag: 'xkeyboard-config-2.34'
      version: '2.34'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.16
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
      regenerate:
        - args: ['./autogen.sh']
          environ:
            NOCONFIGURE: 'yes'
    tools_required:
      - host-autoconf-v2.69
      - host-automake-v1.16
      - host-libtool
      - host-pkg-config
      - host-xorg-macros
      - host-gcc
    pkgs_required:
      - mlibc
      - libx11
      - xorg-proto
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=x86_64-aero'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--with-xkb-rules-symlink=xorg'
        - '--disable-nls'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install-strip']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: xf86-input-keyboard
    source:
      subdir: 'bundled'
      git: 'https://gitlab.freedesktop.org/xorg/driver/xf86-input-keyboard.git'
      tag: 'xf86-input-keyboard-1.9.0'
      version: '1.9.0'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.16
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
      regenerate:
        - args: ['./autogen.sh']
          environ:
            NOCONFIGURE: 'yes'
    tools_required:
      - host-gcc
      - host-autoconf-v2.69
      - host-automake-v1.16
      - host-pkg-config
    pkgs_required:
      - mlibc
      - xorg-server
      - xorg-util-macros
      - libx11
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=x86_64-aero'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
        - '--with-sysroot=@SYSROOT_DIR@' # Set libtool's lt_sysroot.
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install-strip']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: xf86-video-fbdev
    source:
      subdir: 'bundled'
      git: 'https://gitlab.freedesktop.org/xorg/driver/xf86-video-fbdev.git'
      tag: 'xf86-video-fbdev-0.5.0'
      version: '0.5.0'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.16
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
      regenerate:
        - args: ['./autogen.sh']
          environ:
            NOCONFIGURE: 'yes'
    tools_required:
      - host-gcc
      - host-autoconf-v2.69
      - host-automake-v1.16
      - host-pkg-config
    pkgs_required:
      - mlibc
      - xorg-server
      - xorg-util-macros
      - libx11
      - libxrandr
      - libxrender
      - libxv
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=x86_64-aero'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
        - '--with-sysroot=@SYSROOT_DIR@' # Set libtool's lt_sysroot.
        - '--disable-pciaccess'
        environ:
          SYSROOT: '@SYSROOT_DIR@'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install-strip']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: libxtst
    source:
      subdir: 'bundled'
      git: 'https://gitlab.freedesktop.org/xorg/lib/libxtst.git'
      tag: 'libXtst-1.2.4'
      version: '1.2.4'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.16
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
        - host-autoconf-archive
      regenerate:
        - args: ['./autogen.sh']
          environ:
            'NOCONFIGURE': 'yes'
    tools_required:
      - host-gcc
      - host-autoconf-v2.69
      - host-automake-v1.16
      - host-pkg-config
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libx11
      - libxtrans
      - libxext
      - libxi
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=x86_64-aero'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  # X Damage Extension library
  - name: libxdamage
    source:
      subdir: 'bundled'
      git: 'https://gitlab.freedesktop.org/xorg/lib/libxdamage.git'
      tag: 'libXdamage-1.1.5'
      version: '1.1.5'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.16
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
        - host-autoconf-archive
      regenerate:
        - args: ['./autogen.sh']
          environ:
            'NOCONFIGURE': 'yes'
    tools_required:
      - host-gcc
      - host-autoconf-v2.69
      - host-automake-v1.16
      - host-pkg-config
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libx11
      - libxtrans
      - libxfixes
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=x86_64-aero'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: pango
    source:
      subdir: 'bundled'
      git: 'https://gitlab.gnome.org/GNOME/pango.git'
      tag: '1.50.11'
      version: '1.50.11'
    tools_required:
      - host-pkg-config
      - host-gcc
      - host-glib
      - virtual: pkgconfig-for-target
        triple: "x86_64-aero"
    pkgs_required:
      - mlibc
      - glib
      - fontconfig
      - freetype
      - fribidi
      - cairo
      - xorg-proto
      - libx11
      - libxtrans
      - libxext
      - harfbuzz
      - libxft
    revision: 2
    configure:
      - args:
        - 'meson'
        - '--cross-file'
        - '@SOURCE_ROOT@/userland/cross-file.ini'
        - '--prefix=/usr'
        - '--buildtype=release'
        - '-Dintrospection=disabled'
        - '--wrap-mode=nofallback'
        - '@THIS_SOURCE_DIR@'
    build:
      - args: ['ninja']
      - args: ['ninja', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: gdk-pixbuf
    source:
      subdir: 'bundled'
      git: 'https://gitlab.gnome.org/GNOME/gdk-pixbuf.git'
      tag: '2.40.0'
      version: '2.40.0'
    tools_required:
      - host-gcc
      - host-libtool
      - host-pkg-config
      - virtual: pkgconfig-for-target
        triple: "x86_64-aero"
    pkgs_required:
      - mlibc
      - glib
      - libjpeg-turbo
      - libpng
      - shared-mime-info
      - libx11
    configure:
      - args:
        - 'meson'
        - '--cross-file'
        - '@SOURCE_ROOT@/userland/cross-file.ini'
        - '--prefix=/usr'
        - '-Dgir=false'
        - '-Dman=false'
        - '@THIS_SOURCE_DIR@'
    build:
      - args: ['ninja']
      - args: ['ninja', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'
    scripts:
        post_install:
          - args: ['gdk-pixbuf-query-loaders', '--update-cache']

  - name: shared-mime-info
    source:
      subdir: 'bundled'
      git: 'https://gitlab.freedesktop.org/xdg/shared-mime-info.git'
      tag: 'Release-1-15'
      version: '1.15'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.16
        - host-libtool
        - host-pkg-config
      regenerate:
        - args: ['./autogen.sh']
          environ:
            'NOCONFIGURE': 'yes'
    tools_required:
      - host-gcc
      - host-python
    pkgs_required:
      - mlibc
      - glib
      - libxml
      - itstool
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=x86_64-aero'
        - '--prefix=/usr'
        - '--disable-update-mimedb'
        environ:  
          'ITSTOOL': '/usr/bin/itstool'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'
    scripts:
        post_install:
          - args: 'echo "Running update-mime-database; this may take a minute or 2..."'
          - args: '/usr/bin/update-mime-database /usr/share/mime/'

  # Collection of GSettings schemas for GNOME desktop
  #
  # This package contains a collection of GSettings schemas for 
  # settings shared by various components of a GNOME Desktop.
  #- name: gsettings-desktop-schemas
  #  source:
  #    subdir: 'bundled'
  #    git: 'https://gitlab.gnome.org/GNOME/gsettings-desktop-schemas.git'
  #    tag: '42.0'
  #    version: '42.0'
  #  tools_required:
  #    - host-gcc
  #    - host-gobject-introspection
  #    - host-libtool
  #    - host-pkg-config
  #    - virtual: pkgconfig-for-target
  #      triple: "x86_64-aero"
  #  pkgs_required:
  #    - mlibc
  #    - glib
  #  configure:
  #    - args: |
  #            sed -i -r 's:"(/system):"/org/gnome\1:g' @THIS_SOURCE_DIR@/schemas/*.in
  #    - args:
  #      - 'meson'
  #      - '--cross-file'
  #      - '@SOURCE_ROOT@/userland/cross-file.ini'
  #      - '--prefix=/usr'
  #      - '-Dintrospection=false'
  #      - '@THIS_SOURCE_DIR@'
  #  build:
  #    - args: ['ninja']
  #    - args: ['ninja', 'install']
  #      environ:
  #        DESTDIR: '@THIS_COLLECT_DIR@'
  #  scripts:
  #      post_install:
  #        - args: 'glib-compile-schemas /usr/share/glib-2.0/schemas'

  # Deprecated, please don't depend on this anymore. Only here for gtklife and hexchat.
  - name: gtk+-2
    source:
      subdir: 'bundled'
      url: 'https://download.gnome.org/sources/gtk+/2.24/gtk+-2.24.32.tar.xz'
      format: 'tar.xz'
      checksum: blake2b:03f4c0a8be98473f62bc8c86859937969c4169960a5f93d37ff6dcde00413215fa6c7125b15781bf50d67b40aa0056cb71b83fb50acb2c3467b5deb3c8d938f0
      extract_path: 'gtk+-2.24.32'
      patch-path-strip: 1
      version: '2.24.32'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.16
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
        - host-glib
      regenerate:
        - args: ['autoreconf', '-fvi']
    tools_required:
      - host-gcc
      - virtual: pkgconfig-for-target
        triple: "x86_64-aero"
    pkgs_required:
      - mlibc
      - atk
      - cairo
      - glib
      - gdk-pixbuf
      - libx11
      - libxext
      - libxcb
      - pango
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=x86_64-aero'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--with-sysroot=@SYSROOT_DIR@' # Set libtool's lt_sysroot.
        - '--disable-gtk-doc-html'
        - '--disable-cups'
        - '--disable-papi'
        - '--disable-introspection'
        - '--disable-glibtest'
        - '--disable-test-print-backend'
        - '--enable-xkb'
        environ:
          ac_cv_func_getresuid: 'no'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'
        quiet: true
      # Rename a file to avoid conflicts, we will use gtk3 as default, so rename this one.
      - args: ['mv', '-v', '@THIS_COLLECT_DIR@/usr/bin/gtk-update-icon-cache', '@THIS_COLLECT_DIR@/usr/bin/gtk2-update-icon-cache']
    scripts:
        post_install:
          - args: ['gtk-query-immodules-2.0', '--update-cache']
          - args: ['glib-compile-schemas', '/usr/share/glib-2.0/schemas']

  # Collection of GSettings schemas for GNOME desktop
  - name: gsettings-desktop-schemas
    source:
      subdir: 'bundled'
      git: 'https://gitlab.gnome.org/GNOME/gsettings-desktop-schemas.git'
      tag: '42.0'
      version: '42.0'
    tools_required:
      - host-gcc
      - host-gobject-introspection
      - host-libtool
      - host-pkg-config
      - virtual: pkgconfig-for-target
        triple: "x86_64-aero"
    pkgs_required:
      - mlibc
      - glib
    configure:
      - args: |
              sed -i -r 's:"(/system):"/org/gnome\1:g' @THIS_SOURCE_DIR@/schemas/*.in
      - args:
        - 'meson'
        - '--cross-file'
        - '@SOURCE_ROOT@/userland/cross-file.ini'
        - '--prefix=/usr'
        - '-Dintrospection=false'
        - '@THIS_SOURCE_DIR@'
    build:
      - args: ['ninja']
      - args: ['ninja', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'
    scripts:
        post_install:
          - args: 'glib-compile-schemas /usr/share/glib-2.0/schemas'

  - name: gtk+-3
    source:
      subdir: 'bundled'
      git: 'https://gitlab.gnome.org/GNOME/gtk.git'
      tag: '3.24.23'
      version: '3.24.23'
    tools_required:
      - host-gcc
      - virtual: pkgconfig-for-target
        triple: "x86_64-aero"
      - host-glib
    pkgs_required:
      - mlibc
      - atk
      - at-spi2-atk
      - cairo
      - glib
      - gdk-pixbuf
      - libx11
      - libxext
      - libxcb
      - libxrender
      - libxrandr
      - libxfixes
      - libxdamage
      - pango
      - fribidi
      - libepoxy
      - libxkbcommon
      - fontconfig
      - freetype
      - libxi
      - harfbuzz
      - libxcursor
      - gsettings-desktop-schemas
      - dbus
    configure:
      - args:
        - 'meson'
        - '--native-file'
        - '@SOURCE_ROOT@/userland/native-file.ini'
        - '--cross-file'
        - '@SOURCE_ROOT@/userland/cross-file.ini'
        - '--prefix=/usr'
        - '--libdir=lib'
        - '--buildtype=debugoptimized'
        - '-Dprint_backends=file'
        - '-Dintrospection=false'
        - '-Dx11_backend=true'
        - '-Dwayland_backend=false'
        - '-Dbroadway_backend=true'
        - '-Dgtk_doc=false'
        - '-Dcolord=no'
        - '@THIS_SOURCE_DIR@'
    build:
      - args: ['ninja']
      - args: ['ninja', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'
    scripts:
        post_install:
          - args: ['gtk-query-immodules-3.0', '--update-cache']
          - args: ['glib-compile-schemas', '/usr/share/glib-2.0/schemas']

  # X.Org Xcomposite library
  - name: libxcomposite
    source:
      subdir: 'bundled'
      git: 'https://gitlab.freedesktop.org/xorg/lib/libxcomposite.git'
      tag: 'libXcomposite-0.4.5'
      version: '0.4.5'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.16
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
        - host-autoconf-archive
      regenerate:
        - args: ['./autogen.sh']
          environ:
            'NOCONFIGURE': 'yes'
    tools_required:
      - host-gcc
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libx11
      - libxfixes
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=x86_64-aero'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: libxslt
    source:
      subdir: 'bundled'
      git: 'https://gitlab.gnome.org/GNOME/libxslt.git'
      tag: 'v1.1.34'
      version: '1.1.34'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.16
        - host-libtool
        - host-pkg-config
      regenerate:
        - args: ['./autogen.sh']
          environ:
            'NOCONFIGURE': 'yes'
    tools_required:
      - host-gcc
    pkgs_required:
      - mlibc
      - libxml
    configure:
      # BLFS increases the recursion limit, apparently some packages need that to build their documentation.
      - args: ['sed', '-i', 's/3000/5000/', '@THIS_SOURCE_DIR@/libxslt/transform.c']
      - args: ['sed', '-i', 's/3000/5000/', '@THIS_SOURCE_DIR@/doc/xsltproc.1']
      - args: ['sed', '-i', 's/3000/5000/', '@THIS_SOURCE_DIR@/doc/xsltproc.xml']
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=x86_64-aero'
        - '--prefix=/usr'
        - '--disable-static'
        - '--without-crypto'
        - '--without-debug'
        - '--without-debugger'
        - '--without-profiler'
        - '--without-python'
        - '--with-sysroot=@SYSROOT_DIR@' # Set libtool's lt_sysroot.
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: gdk-pixbuf-xlib
    source:
      subdir: 'bundled'
      url: 'https://download.gnome.org/sources/gdk-pixbuf-xlib/2.40/gdk-pixbuf-xlib-2.40.2.tar.xz'
      format: 'tar.xz'
      checksum: blake2b:a515e86bc69f59910f61fe9c275ab89c0732f0aa2cfb614ac94e597de420d25708a11b9b21313c7cfe3763434f45a8318412ae5889c24c8ed57dac68e09c0227
      extract_path: 'gdk-pixbuf-xlib-2.40.2'
      patch-path-strip: 1
      version: '2.40.2'
    tools_required:
      - host-gcc
      - host-libtool
      - host-pkg-config
      - virtual: pkgconfig-for-target
        triple: "x86_64-aero"
    pkgs_required:
      - mlibc
      - gdk-pixbuf
      - libx11
    configure:
      - args:
        - 'meson'
        - '--cross-file'
        - '@SOURCE_ROOT@/userland/cross-file.ini'
        - '--prefix=/usr'
        - '@THIS_SOURCE_DIR@'
    build:
      - args: ['ninja']
      - args: ['ninja', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'
    scripts:
        post_install:
          - args: ['gdk-pixbuf-query-loaders', '--update-cache']
